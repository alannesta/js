<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="script/jquery-1.8.3.js"></script>
    <script src="script/moment.js"></script>
    <script src="eventBus.js"></script>
    <script src="calendar.js"></script>
    <style type="text/css">
        .selected {
            background-color: red;
        }

        .disabled {
            color: grey;
            cursor: not-allowed;
            /*visibility: hidden;*/
        }

        .hover {
            background-color: grey;

        }

        .selected.hover {
            background-color: green;
        }

        td {
            cursor: pointer;
        }

        table {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        #drpicker div[id*="calendar"]{
            float: left;
        }

    </style>
</head>
<body>
<div style="margin:20px">
    <button onclick="previousMonth()">Previous</button>
    <button onclick="nextMonth()">Next</button>
    <!-- <span id ="selected"></span> -->
</div>

<div id="drpicker">
</div>

<script>

    function DateRangePicker(options){
        var self = this;
        var momentNow = moment();
        self.settings = {
            parentEl: $('#drpicker'),
            calCount: 2,    // number of calendars in the drpicker, defaults to 2
            startDate: momentNow.startOf('month').toDate()  // default start month of the drpicker is the current month
        };

        self.view = $('#drpicker');
        self.calendars = [];
        self.calContainers = [];

        self.init = function(){
            init();
        }


        self.bindListeners = function(){


        };

        self.bindHandlers = function(){


        };

        function init(){
//            debugger;
            // step1: generate all calendars containers
            _createCalContainers();

            // step2: generate calendars
            var start = self.settings.startDate;
            for (var i = 0, length = self.calContainers.length; i< length; i++){
                var calendar =  new Calendar({date: start, parentEl: self.calContainers[i], selectionMode: 1});
                self.calendars.push(calendar);
                start = moment(start).add(1, 'months').toDate();
            }
        }

        function _createCalContainers(){
            var baseId = 'calendar';
            var htmlFragment;

            for (var i=0; i<self.settings.calCount; i++){
                htmlFragment = $('<div id="'+ (baseId + i) +'"></div>');
                self.view.append(htmlFragment);
                self.calContainers.push($('#' + baseId + i));
            }
        }

        self.init();

    }

    DateRangePicker.prototype = new EventBus();


    var picker = new DateRangePicker();

    function nextMonth() {
        picker.calendars[0].next();
        picker.calendars[1].next();
    }

    function previousMonth() {
        picker.calendars[0].previous();
        picker.calendars[1].previous();
    }

</script>
</body>
</html>