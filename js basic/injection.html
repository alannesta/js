<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <script src="script/jquery-1.8.3.js"></script>
    <title>injection</title>
</head>
<body>
    <button id="inject">Inject</button>
    <button id="test">Test</button>
    <script>
        $('#inject').click(function() {
            loadScript();
            console.log(window.Intercom);   // undefined
        });

        $('#test').click(function() {
//            var socket = io();
            console.log(window.Intercom);   // injected and evaluated
        });

        function loadScript() {
            var s = document.createElement('script');
            s.type = 'text/javascript';
            s.async = true;
            s.src = 'https://widget.intercom.io/widget/pvbt8bx4';
//            s.src= 'http://localhost:31203/socket.io/socket.io.js';
            var x = document.getElementsByTagName('script')[0];
            x.parentNode.insertBefore(s, x);
        }
    </script>
</body>
</html>